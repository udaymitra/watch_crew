search_chrono24_task:
  description: >
    Search Chrono24.com for "{watch_query}" watches with shipping available
    to US zip code {zip_code}.

    Steps:
    1. Search Google for new "{watch_query}" listings on chrono24.com
       using queries like: {watch_query} new site:chrono24.com
    2. Visit the Chrono24 search results and listing pages
    3. Collect up to {max_results} NEW condition listings with:
       title, price (USD), shipping cost, seller name, location, listing URL
    4. Repeat the search for USED / PRE-OWNED condition listings
    5. Sort each category by price ascending
    6. Return the top {top_n} cheapest in each category

  expected_output: >
    Structured JSON matching the WatchSearchResults model with cheapest new
    and used listings from Chrono24, including prices, shipping, and URLs.
  agent: chrono24_scraper

search_jomashop_task:
  description: >
    Search Jomashop.com for "{watch_query}" watches with shipping to US
    zip code {zip_code}.

    Steps:
    1. Search Google for "{watch_query}" listings on jomashop.com
       using queries like: {watch_query} site:jomashop.com
    2. Visit Jomashop search results and product pages
    3. Collect up to {max_results} NEW condition listings with:
       title, price (USD), shipping cost, seller info, listing URL
    4. Search for any PRE-OWNED listings of the same watch
    5. Sort each category by price ascending
    6. Return the top {top_n} cheapest in each category

  expected_output: >
    Structured JSON matching the WatchSearchResults model with cheapest new
    and used listings from Jomashop, including prices, shipping, and URLs.
  agent: jomashop_scraper

analyze_prices_task:
  description: >
    Analyze the watch search results from both Chrono24 and Jomashop for
    "{watch_query}" and provide comprehensive pricing insights.

    Analysis steps:
    1. Price statistics per site per condition (min, max, median, average)
    2. Cross-site comparison: which seller is cheaper for new? For used?
    3. New vs used premium percentage on each site
    4. Factor in shipping costs for true total cost comparison
    5. Identify the single best new listing across all sites
    6. Identify the single best used listing across all sites
    7. Identify the overall best deal regardless of condition
    8. Flag any pricing anomalies (suspiciously low, much higher than peers)
    9. Provide a clear new vs used recommendation with reasoning

  expected_output: >
    Structured JSON matching the WatchPriceAnalysis model with complete
    pricing statistics, recommendations, and market observations.
  agent: watch_analyst
  context: [search_chrono24_task, search_jomashop_task]

generate_report_task:
  description: >
    Create a comprehensive markdown report for "{watch_query}" combining
    search results and pricing analysis. Format in markdown without code blocks.

    Sections:
    ## Search Summary
    - Watch searched, date, sites checked, total listings found

    ## Chrono24 Listings
    - Table of cheapest new listings (price, shipping, total, seller, link)
    - Table of cheapest used listings

    ## Jomashop Listings
    - Table of cheapest new listings
    - Table of cheapest used listings

    ## Cross-Site Price Comparison
    - Side-by-side price stats (Chrono24 vs Jomashop)
    - New vs used premium on each site
    - Which site offers better deals

    ## Recommendations
    - Best new listing with reasoning
    - Best used listing with reasoning
    - Best overall deal
    - New vs used recommendation

  expected_output: >
    A markdown report with tables comparing watch prices across Chrono24
    and Jomashop, with clear buying recommendations.
  agent: watch_analyst
  context: [search_chrono24_task, search_jomashop_task, analyze_prices_task]
